---
title: "code2vec"
emoji: "ğŸ“š"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

è‡ªèº«ã®ç ”ç©¶ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ¼ãƒ‰ã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã™ã‚‹éš›ã®æŠ€è¡“ã«ã¤ã„ã¦èª¿ã¹ã¦ã„ãŸã‚‰ï¼Œ[code2vec](https://arxiv.org/abs/1803.09473) ã«å‡ºä¼šã£ãŸã®ã§ï¼Œä»Šå›ã¯ãã®æ‰‹æ³•ã«ã¤ã„ã¦å…·ä½“çš„ã«ã¾ã¨ã‚ãŸã‚‚ã®ã‚’è‡ªåˆ†ã®å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¾ã™ã€‚

## TL;DR

- ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã«å¤‰æ›ã—ã¦ï¼Œãã®æ§‹é€ ã‚’ãƒ™ã‚¯ãƒˆãƒ«åŒ–
- ãƒ™ã‚¯ãƒˆãƒ«åŒ–ã—ãŸã‚‚ã®ã‚’ã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãƒ»ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ã„ã†ã‚‚ã®ã‚’ä½¿ã£ã¦ï¼Œã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆå…¨ä½“ã‚’è¡¨ã™å˜ä¸€ã®ã‚³ãƒ¼ãƒ‰ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›
- å¤‰æ›ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãƒ™ã‚¯ãƒˆãƒ«ã¯ï¼Œãƒ¡ã‚½ãƒƒãƒ‰åãªã©ã®ã‚³ãƒ¼ãƒ‰ç‰¹æ€§ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹

## ç†è«–ã®éƒ¨åˆ†

ç†è«–ã®éƒ¨åˆ†ã«é–¢ã—ã¦ã¯[ã“ã¡ã‚‰](https://qiita.com/m3yrin/items/b7b11ec2c7d045d07efb)ã®è¨˜äº‹ãŒè©³ã—ã„ã®ã§ï¼Œãã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
https://qiita.com/m3yrin/items/b7b11ec2c7d045d07efb#tldr

## å®Ÿè£…ã®æµã‚Œ ~ ã‚¤ãƒ¡ãƒ¼ã‚¸ ~

ä»Šå›ã¯ä¸‹è¨˜ã®é–¢æ•°å f ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ä¾‹ã«ã—ã¦ï¼Œcode2vec ãŒã©ã®ã‚ˆã†ã«ã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰åã‚’äºˆæ¸¬ã—ã¦ã„ã‚‹ã®ã‹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼â¤ï¸â€ğŸ”¥

```java
public boolean f(int[] array, int target) {
    for (int num : array) {
        if (num == target) {
            return true;
        }
    }
    return false;
}
```

### 1. æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã®ç”Ÿæˆ

code2vec ã¯ï¼Œã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‹ã‚‰ æŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã‚’ä½œã‚‹ãŸã‚ã«**Parser**ã‚’ä½¿ç”¨ã—ã¾ã™ï¼

[IT è¾æ›¸](https://e-words.jp/w/%E3%83%91%E3%83%BC%E3%82%B5.html)ã«ã‚ˆã‚‹ã¨ï¼ŒParserï¼ˆãƒ‘ãƒ¼ã‚µï¼‰ã¨ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼

> ãƒ‘ãƒ¼ã‚µï¼ˆparserï¼‰ã¨ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚„ XML æ–‡æ›¸ãªã©ã€ä½•ã‚‰ã‹ã®è¨€èªã§è¨˜è¿°ã•ã‚ŒãŸæ§‹é€ çš„ãªæ–‡å­—ãƒ‡ãƒ¼ã‚¿ã‚’è§£æã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§æ‰±ãˆã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®é›†åˆä½“ã«å¤‰æ›ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã€‚ãã®ã‚ˆã†ãªå‡¦ç†ã®ã“ã¨ã‚’ã€Œæ§‹æ–‡è§£æã€ã€Œãƒ‘ãƒ¼ã‚¹ã€(parse)ã¨ã„ã†ã€‚

ä»Šå›ã®å ´åˆã® Parser ã¯ï¼Œ
**Java ã®ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’è§£æã—ã¦ï¼ŒæŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¤‰æ›ã—ã¦ã„ã‚‹**
ã¨ã„ã†ã“ã¨ã§ã™ã­ï¼

å¤‰æ›ã•ã‚Œã¦ã§ããŸæŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ ğŸ‘‡
![](/images/2024-12-30-code2vec/ast_example.png)

:::message
[ã“ã¡ã‚‰](https://code2vec.org/)ã‹ã‚‰ AST å›³ã‚’ä½œæˆå¯èƒ½
:::

### 2. ãƒ‘ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æŠ½å‡º

æ¬¡ã«å…ˆã»ã©ç”Ÿæˆã—ãŸæŠ½è±¡æ§‹æ–‡æœ¨ï¼ˆASTï¼‰ã‹ã‚‰**ãƒ‘ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã‚’æŠ½å‡ºã—ã¾ã™ï¼
ä¸‹è¨˜ãŒè«–æ–‡ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ‘ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å®šç¾©ã§ã™ï¼ãªã‚“ã®ã“ã£ã¡ã‚ƒåˆ†ã‹ã‚Šã¾ã›ã‚“ã­... ğŸ˜…

> **Definition** **(Path-context)**
> Given an AST Path $p$, its path-context is a triplet <$x_s$, $p$, $x_t$> where $x_s = \phi(start(p))$ and $x_t = \phi(end(p))$ are the values associated with the start and end terminals of $p$.

ã“ã®å®šç¾©ã§è¨€ã„ãŸã„ã“ã¨ã¨ã—ã¦ã¯ï¼ŒAST ãƒãƒ¼ãƒ‰é–“ã®ãƒ‘ã‚¹ã‚’å–ã‚Šå‡ºã—ã¦ï¼Œãã‚Œãã‚Œã‚’ **ã€Œå§‹ç‚¹ - çµŒè·¯ï¼ˆå§‹ç‚¹ã¨çµ‚ç‚¹ã®é–“ã®éƒ¨åˆ†ï¼‰ - çµ‚ç‚¹ã€** ã¨ã—ã¦è¡¨ç¾ã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ï¼

ãªã‚“ã®ã“ã£ã¡ã‚ƒåˆ†ã‹ã‚‰ãªã„ã®ã§ï¼Œå…·ä½“ä¾‹ã§è€ƒãˆã¦ã„ãã¾ã—ã‚‡ã†ï¼

$x = 7$ã®å ´åˆã®è¡¨ç¾ã¯ä¸‹è¨˜ã®é€šã‚Š ğŸ‘‡
$$<x, (NameExpr â†‘ AssignExpr â†“ IntegerLiteralExpr), 7>$$

## å‚è€ƒæ–‡çŒ®

https://arxiv.org/abs/1803.09473
https://e-words.jp/w/%E3%83%91%E3%83%BC%E3%82%B5.html
https://code2vec.org/
